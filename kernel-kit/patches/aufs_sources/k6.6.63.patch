--- aufs6-mmap.patch.orig	2024-11-30 12:04:39.029931230 +0000
+++ aufs6-mmap.patch	2024-11-30 11:42:03.209949373 +0000
@@ -219,14 +219,14 @@
  				vma = merge;
  				/* Update vm_flags to pick up the change. */
 @@ -2904,7 +2904,7 @@ unsigned long mmap_region(struct file *file, unsigned long addr,
+ 	return addr;
  
- 	if (file || vma->vm_file) {
- unmap_and_free_vma:
--		fput(vma->vm_file);
-+		vma_fput(vma);
- 		vma->vm_file = NULL;
+ unmap_and_free_file_vma:
+-	fput(vma->vm_file);
++	vma_fput(vma);
+ 	vma->vm_file = NULL;
  
- 		vma_iter_set(&vmi, vma->vm_end);
+ 	vma_iter_set(&vmi, vma->vm_end);
 @@ -2966,6 +2966,9 @@ SYSCALL_DEFINE5(remap_file_pages, unsigned long, start, unsigned long, size,
  	unsigned long populate = 0;
  	unsigned long ret = -EINVAL;
